{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/mann/CodeCompass_DEMO_FALL2025/codecompass/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,4KAAmB;QAClB,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///home/mann/CodeCompass_DEMO_FALL2025/codecompass/src/components/ui/field.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field flex w-full gap-3 data-[invalid=true]:text-destructive\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:items-start has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n        responsive: [\n          \"flex-col [&>*]:w-full [&>.sr-only]:w-auto @md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>*]:data-[slot=field]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm leading-snug font-medium group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm leading-normal font-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"last:mt-0 nth-last-2:-mt-1 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors?.length) {\n      return null\n    }\n\n    if (errors?.length == 1) {\n      return errors[0]?.message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///home/mann/CodeCompass_DEMO_FALL2025/codecompass/src/lib/services/orgService.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient, createAdminClient } from \"@/utils/supabase/server\";\nimport {\n  Organization,\n  OrganizationWithRole,\n  OrganizationMember,\n} from \"@/app/types/supabase\";\nimport { ActionResult } from \"@/app/types/action\";\n\nexport async function getOrgs(): Promise<ActionResult<OrganizationWithRole[]>> {\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not found\" };\n  }\n\n  // Query from user_organizations table to properly filter by user_id\n  const { data: userOrgs, error: organizationsError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"role,joined_at,organizations(id,name,created_at)\")\n    .eq(\"user_id\", user.id);\n\n  if (organizationsError) {\n    return { success: false, error: organizationsError.message };\n  }\n\n  // Transform the data to match OrganizationWithRole structure\n  const organizations: OrganizationWithRole[] = (userOrgs ?? []).map((uo) => {\n    const org = uo.organizations as Organization | Organization[];\n    // Handle case where organizations might be an array (shouldn't happen with proper FK)\n    const orgData = Array.isArray(org) ? org[0] : org;\n\n    return {\n      id: orgData.id,\n      name: orgData.name,\n      created_at: orgData.created_at,\n      role: uo.role,\n      joined_at: uo.joined_at,\n    };\n  });\n\n  return {\n    success: true,\n    data: organizations,\n  };\n}\n\nexport async function getOrgById(\n  orgId: string,\n): Promise<ActionResult<Organization>> {\n  const supabase = await createClient();\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not found\" };\n  }\n\n  const { data: organization, error } = await supabase\n    .from(\"organizations\")\n    .select(\"id,name,created_at\")\n    .eq(\"id\", orgId)\n    .single();\n\n  if (error) {\n    return { success: false, error: error.message };\n  }\n\n  if (!organization) {\n    return { success: false, error: \"Organization not found\" };\n  }\n\n  return { success: true, data: organization };\n}\n\nexport async function getOrgMembers(\n  orgId: string,\n): Promise<ActionResult<OrganizationMember[]>> {\n  const supabase = await createClient();\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not authenticated\" };\n  }\n\n  // Verify user has access to this organization\n  const { data: userOrg, error: accessError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"organization_id\")\n    .eq(\"organization_id\", orgId)\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (accessError || !userOrg) {\n    return { success: false, error: \"Access denied to this organization\" };\n  }\n\n  // Fetch all members of the organization with their user details\n  // Join with users table to get email addresses\n  const { data: members, error: membersError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"user_id, organization_id, role, joined_at, users(email)\")\n    .eq(\"organization_id\", orgId)\n    .order(\"joined_at\", { ascending: true });\n\n  if (membersError) {\n    return { success: false, error: membersError.message };\n  }\n\n  if (!members || members.length === 0) {\n    return { success: true, data: [] };\n  }\n\n  // Transform the joined data to match OrganizationMember type\n  const membersWithEmails: OrganizationMember[] = members.map((m) => {\n    // Handle the users field which could be an object or array due to the join\n    const userData = m.users as { email: string } | { email: string }[] | null;\n    const email = Array.isArray(userData)\n      ? userData[0]?.email || \"Unknown\"\n      : userData?.email || \"Unknown\";\n\n    return {\n      user_id: m.user_id,\n      organization_id: m.organization_id,\n      role: m.role as \"owner\" | \"teammate\",\n      joined_at: m.joined_at,\n      user_email: email,\n    };\n  });\n\n  return { success: true, data: membersWithEmails };\n}\n\nexport async function createOrg(\n  formData: FormData,\n): Promise<ActionResult<Organization>> {\n  const supabase = await createClient();\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not found\" };\n  }\n\n  const name = formData.get(\"name\") as string;\n\n  if (!name || name.trim() === \"\") {\n    return { success: false, error: \"Organization name is required\" };\n  }\n\n  const { data: organization, error: organizationError } = await supabase\n    .from(\"organizations\")\n    .insert({\n      name: name.trim(),\n    })\n    .select()\n    .single();\n\n  if (organizationError) {\n    return { success: false, error: organizationError.message };\n  }\n\n  const { error: userOrganizationError } = await supabase\n    .from(\"user_organizations\")\n    .insert({\n      user_id: user.id,\n      organization_id: organization.id,\n      role: \"owner\",\n    })\n    .select()\n    .single();\n\n  if (userOrganizationError) {\n    return { success: false, error: userOrganizationError.message };\n  }\n\n  return { success: true, data: organization };\n}\n\nexport async function createInviteLink(\n  organizationId: string,\n): Promise<ActionResult<{ token: string; expiresAt: string }>> {\n  const supabase = await createClient();\n\n  //authenticate user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not authenticated!\" };\n  }\n\n  //check membership\n  const { data: userOrg, error: accessError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"organization_id, role\")\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (accessError || !userOrg) {\n    return {\n      success: false,\n      error: \"User does not have access to this organization!\",\n    };\n  }\n\n  //generate a secure token\n\n  const token = crypto.randomUUID();\n\n  //calculate expiry date\n  const expiresAt = new Date();\n  expiresAt.setDate(expiresAt.getDate() + 7);\n\n  //store the invite in supa\n\n  const { error: inviteError } = await supabase\n    .from(\"organization_invites\")\n    .insert({\n      organization_id: organizationId,\n      created_by: user.id,\n      token,\n      expires_at: expiresAt.toISOString(),\n    });\n\n  if (inviteError) {\n    console.error(\"Failed to create invite:\", inviteError);\n    return { success: false, error: \"Failed to create invite link\" };\n  }\n\n  return {\n    success: true,\n    data: {\n      token,\n      expiresAt: expiresAt.toISOString(),\n    },\n  };\n}\n\nexport async function acceptInvite(\n  token: string,\n): Promise<ActionResult<{ organizationId: string }>> {\n  const supabase = await createClient();\n\n  // 1. Authenticate user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return {\n      success: false,\n      error: \"You must be logged in to accept an invite\",\n    };\n  }\n\n  // 2. Fetch and validate invite (with locking to prevent race conditions)\n  const { data: invite, error: inviteError } = await supabase\n    .from(\"organization_invites\")\n    .select(\"*\")\n    .eq(\"token\", token)\n    .is(\"used_at\", null) // Only get unused invites\n    .single();\n\n  if (inviteError || !invite) {\n    return { success: false, error: \"Invalid or expired invite link\" };\n  }\n\n  // 3. Check expiration\n  const now = new Date();\n  const expiresAt = new Date(invite.expires_at);\n  if (now > expiresAt) {\n    return { success: false, error: \"This invite has expired\" };\n  }\n\n  // 4. Check if user is already a member\n  const { data: existingMembership } = await supabase\n    .from(\"user_organizations\")\n    .select(\"organization_id\")\n    .eq(\"organization_id\", invite.organization_id)\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (existingMembership) {\n    return {\n      success: false,\n      error: \"You are already a member of this organization\",\n    };\n  }\n\n  // 5. Add user to organization\n  const { error: membershipError } = await supabase\n    .from(\"user_organizations\")\n    .insert({\n      user_id: user.id,\n      organization_id: invite.organization_id,\n      role: \"teammate\", // Default role for invited users\n    });\n\n  if (membershipError) {\n    console.error(\"Failed to add user to organization:\", membershipError);\n    return { success: false, error: \"Failed to join organization\" };\n  }\n\n  // 6. Mark invite as used (using admin client with secret key to bypass RLS)\n  const adminClient = createAdminClient();\n  const { error: updateError } = await adminClient\n    .from(\"organization_invites\")\n    .update({\n      used_at: new Date().toISOString(),\n      used_by: user.id,\n    })\n    .eq(\"token\", token);\n\n  if (updateError) {\n    console.error(\"Failed to mark invite as used:\", updateError);\n    // Don't return error - user was already added successfully\n  }\n\n  return {\n    success: true,\n    data: { organizationId: invite.organization_id },\n  };\n}\n\nexport async function removeMemberFromOrg(\n  organizationId: string,\n  userIdToRemove: string,\n): Promise<ActionResult<void>> {\n  const supabase = await createClient();\n\n  // 1. Authenticate user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not authenticated\" };\n  }\n\n  // 2. Verify current user is an owner (RLS will also enforce this)\n  const { data: currentUserRole, error: roleError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"role\")\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (roleError || !currentUserRole || currentUserRole.role !== \"owner\") {\n    return {\n      success: false,\n      error: \"Only organization owners can remove members\",\n    };\n  }\n\n  // 3. Check if the user being removed is the last owner\n  if (userIdToRemove === user.id) {\n    const { data: owners, error: ownersError } = await supabase\n      .from(\"user_organizations\")\n      .select(\"user_id\")\n      .eq(\"organization_id\", organizationId)\n      .eq(\"role\", \"owner\");\n\n    if (ownersError) {\n      return { success: false, error: \"Failed to verify ownership status\" };\n    }\n\n    if (owners && owners.length <= 1) {\n      return {\n        success: false,\n        error: \"Cannot remove the last owner from the organization\",\n      };\n    }\n  }\n\n  // 4. Remove the member (RLS policy will enforce owner permission)\n  const { error: deleteError } = await supabase\n    .from(\"user_organizations\")\n    .delete()\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", userIdToRemove);\n\n  if (deleteError) {\n    return { success: false, error: \"Failed to remove member\" };\n  }\n\n  return { success: true, data: undefined };\n}\n\nexport async function leaveOrganization(\n  organizationId: string,\n): Promise<ActionResult<void>> {\n  const supabase = await createClient();\n\n  // 1. Authenticate user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not authenticated\" };\n  }\n\n  // 2. Verify user is a member of this organization\n  const { data: membership, error: membershipError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"role\")\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (membershipError || !membership) {\n    return {\n      success: false,\n      error: \"You are not a member of this organization\",\n    };\n  }\n\n  // 3. If user is an owner, check if they're the last owner\n  if (membership.role === \"owner\") {\n    const { data: owners, error: ownersError } = await supabase\n      .from(\"user_organizations\")\n      .select(\"user_id\")\n      .eq(\"organization_id\", organizationId)\n      .eq(\"role\", \"owner\");\n\n    if (ownersError) {\n      return { success: false, error: \"Failed to verify ownership status\" };\n    }\n\n    if (owners && owners.length <= 1) {\n      return {\n        success: false,\n        error: \"Cannot leave as the last owner. Transfer ownership first.\",\n      };\n    }\n  }\n\n  // 4. Remove the user from the organization\n  const { error: deleteError } = await supabase\n    .from(\"user_organizations\")\n    .delete()\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", user.id);\n\n  if (deleteError) {\n    return { success: false, error: \"Failed to leave organization\" };\n  }\n\n  return { success: true, data: undefined };\n}\n\nexport async function updateMemberRole(\n  organizationId: string,\n  userIdToUpdate: string,\n  newRole: \"owner\" | \"teammate\",\n): Promise<ActionResult<void>> {\n  const supabase = await createClient();\n\n  // 1. Authenticate user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { success: false, error: \"User not authenticated\" };\n  }\n\n  // 2. Verify current user is an owner\n  const { data: currentUserRole, error: roleError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"role\")\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (roleError || !currentUserRole || currentUserRole.role !== \"owner\") {\n    return {\n      success: false,\n      error: \"Only organization owners can change member roles\",\n    };\n  }\n\n  // 3. Get current role of user being updated\n  const { data: targetUser, error: targetError } = await supabase\n    .from(\"user_organizations\")\n    .select(\"role\")\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", userIdToUpdate)\n    .single();\n\n  if (targetError || !targetUser) {\n    return { success: false, error: \"Member not found\" };\n  }\n\n  // 4. If demoting from owner to teammate, check if they're the last owner\n  if (targetUser.role === \"owner\" && newRole === \"teammate\") {\n    const { data: owners, error: ownersError } = await supabase\n      .from(\"user_organizations\")\n      .select(\"user_id\")\n      .eq(\"organization_id\", organizationId)\n      .eq(\"role\", \"owner\");\n\n    if (ownersError) {\n      return { success: false, error: \"Failed to verify ownership status\" };\n    }\n\n    if (owners && owners.length <= 1) {\n      return {\n        success: false,\n        error: \"Cannot demote the last owner. Promote another member first.\",\n      };\n    }\n  }\n\n  // 5. Update the role\n  const { error: updateError } = await supabase\n    .from(\"user_organizations\")\n    .update({ role: newRole })\n    .eq(\"organization_id\", organizationId)\n    .eq(\"user_id\", userIdToUpdate);\n\n  if (updateError) {\n    return { success: false, error: \"Failed to update member role\" };\n  }\n\n  return { success: true, data: undefined };\n}\n"],"names":[],"mappings":";;;;;;;IA8IsB,YAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"}},
    {"offset": {"line": 312, "column": 0}, "map": {"version":3,"sources":["file:///home/mann/CodeCompass_DEMO_FALL2025/codecompass/src/components/dashboard/organizations/new-organization-form.tsx"],"sourcesContent":["\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n} from \"@/components/ui/field\";\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { createOrg } from \"@/lib/services/orgService\";\nimport { useQueryClient } from \"@tanstack/react-query\";\n\nexport function NewOrganizationForm() {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n  const [name, setName] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const formData = new FormData(e.currentTarget);\n      const result = await createOrg(formData);\n\n      if (!result.success) {\n        setError(result.error);\n        return;\n      }\n\n      // Invalidate organizations query to refetch fresh data\n      queryClient.invalidateQueries({ queryKey: [\"organizations\"] });\n\n      // Redirect to organizations page after creation\n      router.push(\"/dashboard/organizations\");\n    } catch (err) {\n      setError(\n        err instanceof Error ? err.message : \"Failed to create organization\",\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col bg-elevated\">\n      <form\n        onSubmit={handleSubmit}\n        className=\"space-y-6 px-5 py-5 border rounded-md\"\n      >\n        <div className=\"flex flex-col gap-1\">\n          <span className=\"text-foreground\">Create a new Organization</span>\n          <span className=\"text-muted-foreground text-xs\">\n            Organizations are a way to group repositories together. Each\n            organization can be accessed by different team members.\n          </span>\n        </div>\n        <Separator />\n\n        <Field>\n          <FieldLabel htmlFor=\"name\">Name</FieldLabel>\n          <input\n            id=\"name\"\n            name=\"name\"\n            type=\"text\"\n            value={name}\n            onChange={(e) => setName(e.target.value)}\n            placeholder=\"Organization name\"\n            required\n            className=\"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent\"\n          />\n          <FieldDescription>\n            Choose a unique name for your organization\n          </FieldDescription>\n          <FieldError>{error}</FieldError>\n        </Field>\n\n        <Separator />\n\n        <div className=\"flex gap-3\">\n          <Button type=\"submit\" size=\"sm\" disabled={isLoading || !name.trim()}>\n            {isLoading ? \"Creating...\" : \"Create Organization\"}\n          </Button>\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => router.back()}\n            disabled={isLoading}\n          >\n            Cancel\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAMA;AACA;AACA;AACA;;;AAbA;;;;;;;;AAeO,SAAS;;IACd,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,aAAa;QACb,SAAS;QAET,IAAI;YACF,MAAM,WAAW,IAAI,SAAS,EAAE,aAAa;YAC7C,MAAM,SAAS,MAAM,IAAA,8KAAS,EAAC;YAE/B,IAAI,CAAC,OAAO,OAAO,EAAE;gBACnB,SAAS,OAAO,KAAK;gBACrB;YACF;YAEA,uDAAuD;YACvD,YAAY,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;iBAAgB;YAAC;YAE5D,gDAAgD;YAChD,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,KAAK;YACZ,SACE,eAAe,QAAQ,IAAI,OAAO,GAAG;QAEzC,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YACC,UAAU;YACV,WAAU;;8BAEV,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAK,WAAU;sCAAkB;;;;;;sCAClC,6LAAC;4BAAK,WAAU;sCAAgC;;;;;;;;;;;;8BAKlD,6LAAC,qJAAS;;;;;8BAEV,6LAAC,6IAAK;;sCACJ,6LAAC,kJAAU;4BAAC,SAAQ;sCAAO;;;;;;sCAC3B,6LAAC;4BACC,IAAG;4BACH,MAAK;4BACL,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;4BACvC,aAAY;4BACZ,QAAQ;4BACR,WAAU;;;;;;sCAEZ,6LAAC,wJAAgB;sCAAC;;;;;;sCAGlB,6LAAC,kJAAU;sCAAE;;;;;;;;;;;;8BAGf,6LAAC,qJAAS;;;;;8BAEV,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,+IAAM;4BAAC,MAAK;4BAAS,MAAK;4BAAK,UAAU,aAAa,CAAC,KAAK,IAAI;sCAC9D,YAAY,gBAAgB;;;;;;sCAE/B,6LAAC,+IAAM;4BACL,MAAK;4BACL,SAAQ;4BACR,MAAK;4BACL,SAAS,IAAM,OAAO,IAAI;4BAC1B,UAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX;GAvFgB;;QACC,kJAAS;QACJ,2MAAc;;;KAFpB"}},
    {"offset": {"line": 510, "column": 0}, "map": {"version":3,"sources":["file:///home/mann/CodeCompass_DEMO_FALL2025/codecompass/node_modules/%40radix-ui/react-label/node_modules/%40radix-ui/react-primitive/src/primitive.tsx"],"sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { createSlot } from '@radix-ui/react-slot';\n\nconst NODES = [\n  'a',\n  'button',\n  'div',\n  'form',\n  'h2',\n  'h3',\n  'img',\n  'input',\n  'label',\n  'li',\n  'nav',\n  'ol',\n  'p',\n  'select',\n  'span',\n  'svg',\n  'ul',\n] as const;\n\ntype Primitives = { [E in (typeof NODES)[number]]: PrimitiveForwardRefComponent<E> };\ntype PrimitivePropsWithRef<E extends React.ElementType> = React.ComponentPropsWithRef<E> & {\n  asChild?: boolean;\n};\n\ninterface PrimitiveForwardRefComponent<E extends React.ElementType>\n  extends React.ForwardRefExoticComponent<PrimitivePropsWithRef<E>> {}\n\n/* -------------------------------------------------------------------------------------------------\n * Primitive\n * -----------------------------------------------------------------------------------------------*/\n\nconst Primitive = NODES.reduce((primitive, node) => {\n  const Slot = createSlot(`Primitive.${node}`);\n  const Node = React.forwardRef((props: PrimitivePropsWithRef<typeof node>, forwardedRef: any) => {\n    const { asChild, ...primitiveProps } = props;\n    const Comp: any = asChild ? Slot : node;\n\n    if (typeof window !== 'undefined') {\n      (window as any)[Symbol.for('radix-ui')] = true;\n    }\n\n    return <Comp {...primitiveProps} ref={forwardedRef} />;\n  });\n\n  Node.displayName = `Primitive.${node}`;\n\n  return { ...primitive, [node]: Node };\n}, {} as Primitives);\n\n/* -------------------------------------------------------------------------------------------------\n * Utils\n * -----------------------------------------------------------------------------------------------*/\n\n/**\n * Flush custom event dispatch\n * https://github.com/radix-ui/primitives/pull/1378\n *\n * React batches *all* event handlers since version 18, this introduces certain considerations when using custom event types.\n *\n * Internally, React prioritises events in the following order:\n *  - discrete\n *  - continuous\n *  - default\n *\n * https://github.com/facebook/react/blob/a8a4742f1c54493df00da648a3f9d26e3db9c8b5/packages/react-dom/src/events/ReactDOMEventListener.js#L294-L350\n *\n * `discrete` is an  important distinction as updates within these events are applied immediately.\n * React however, is not able to infer the priority of custom event types due to how they are detected internally.\n * Because of this, it's possible for updates from custom events to be unexpectedly batched when\n * dispatched by another `discrete` event.\n *\n * In order to ensure that updates from custom events are applied predictably, we need to manually flush the batch.\n * This utility should be used when dispatching a custom event from within another `discrete` event, this utility\n * is not necessary when dispatching known event types, or if dispatching a custom type inside a non-discrete event.\n * For example:\n *\n * dispatching a known click \uD83D\uDC4E\n * target.dispatchEvent(new Event(\u2018click\u2019))\n *\n * dispatching a custom type within a non-discrete event \uD83D\uDC4E\n * onScroll={(event) => event.target.dispatchEvent(new CustomEvent(\u2018customType\u2019))}\n *\n * dispatching a custom type within a `discrete` event \uD83D\uDC4D\n * onPointerDown={(event) => dispatchDiscreteCustomEvent(event.target, new CustomEvent(\u2018customType\u2019))}\n *\n * Note: though React classifies `focus`, `focusin` and `focusout` events as `discrete`, it's  not recommended to use\n * this utility with them. This is because it's possible for those handlers to be called implicitly during render\n * e.g. when focus is within a component as it is unmounted, or when managing focus on mount.\n */\n\nfunction dispatchDiscreteCustomEvent<E extends CustomEvent>(target: E['target'], event: E) {\n  if (target) ReactDOM.flushSync(() => target.dispatchEvent(event));\n}\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst Root = Primitive;\n\nexport {\n  Primitive,\n  //\n  Root,\n  //\n  dispatchDiscreteCustomEvent,\n};\nexport type { PrimitivePropsWithRef };\n"],"names":[],"mappings":";;;;;;;;;AAAA,YAAY,WAAW;AACvB,YAAY,cAAc;AAC1B,SAAS,kBAAkB;AA4ChB;;;;;AA1CX,IAAM,QAAQ;IACZ;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACF;AAcA,IAAM,YAAY,MAAM,MAAA,CAAO,CAAC,WAAW,SAAS;IAClD,MAAM,WAAO,iLAAA,EAAW,CAAA,UAAA,EAAa,IAAI,EAAE;IAC3C,MAAM,OAAa,2KAAA,CAAW,CAAC,OAA2C,iBAAsB;QAC9F,MAAM,EAAE,OAAA,EAAS,GAAG,eAAe,CAAA,GAAI;QACvC,MAAM,OAAY,UAAU,OAAO;QAEnC,IAAI,OAAO,WAAW,aAAa;YAChC,MAAA,CAAe,OAAO,GAAA,CAAI,UAAU,CAAC,CAAA,GAAI;QAC5C;QAEA,OAAO,aAAA,GAAA,IAAA,6KAAA,EAAC,MAAA;YAAM,GAAG,cAAA;YAAgB,KAAK;QAAA,CAAc;IACtD,CAAC;IAED,KAAK,WAAA,GAAc,CAAA,UAAA,EAAa,IAAI,EAAA;IAEpC,OAAO;QAAE,GAAG,SAAA;QAAW,CAAC,IAAI,CAAA,EAAG;IAAK;AACtC,GAAG,CAAC,CAAe;AA2CnB,SAAS,4BAAmD,MAAA,EAAqB,KAAA,EAAU;IACzF,IAAI,OAAQ,CAAS,iLAAA,CAAU,IAAM,OAAO,aAAA,CAAc,KAAK,CAAC;AAClE;AAIA,IAAM,OAAO"}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":["file:///home/mann/CodeCompass_DEMO_FALL2025/codecompass/node_modules/%40radix-ui/react-label/src/label.tsx"],"sourcesContent":["import * as React from 'react';\nimport { Primitive } from '@radix-ui/react-primitive';\n\n/* -------------------------------------------------------------------------------------------------\n * Label\n * -----------------------------------------------------------------------------------------------*/\n\nconst NAME = 'Label';\n\ntype LabelElement = React.ComponentRef<typeof Primitive.label>;\ntype PrimitiveLabelProps = React.ComponentPropsWithoutRef<typeof Primitive.label>;\ninterface LabelProps extends PrimitiveLabelProps {}\n\nconst Label = React.forwardRef<LabelElement, LabelProps>((props, forwardedRef) => {\n  return (\n    <Primitive.label\n      {...props}\n      ref={forwardedRef}\n      onMouseDown={(event) => {\n        // only prevent text selection if clicking inside the label itself\n        const target = event.target as HTMLElement;\n        if (target.closest('button, input, select, textarea')) return;\n\n        props.onMouseDown?.(event);\n        // prevent text selection when double clicking label\n        if (!event.defaultPrevented && event.detail > 1) event.preventDefault();\n      }}\n    />\n  );\n});\n\nLabel.displayName = NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst Root = Label;\n\nexport {\n  Label,\n  //\n  Root,\n};\nexport type { LabelProps };\n"],"names":[],"mappings":";;;;;;;AAAA,YAAY,WAAW;AACvB,SAAS,iBAAiB;AActB;;;;;AARJ,IAAM,OAAO;AAMb,IAAM,QAAc,2KAAA,CAAqC,CAAC,OAAO,iBAAiB;IAChF,OACE,aAAA,GAAA,IAAA,6KAAA,EAAC,wOAAA,CAAU,KAAA,EAAV;QACE,GAAG,KAAA;QACJ,KAAK;QACL,aAAa,CAAC,UAAU;YAEtB,MAAM,SAAS,MAAM,MAAA;YACrB,IAAI,OAAO,OAAA,CAAQ,iCAAiC,EAAG,CAAA;YAEvD,MAAM,WAAA,GAAc,KAAK;YAEzB,IAAI,CAAC,MAAM,gBAAA,IAAoB,MAAM,MAAA,GAAS,EAAG,CAAA,MAAM,cAAA,CAAe;QACxE;IAAA;AAGN,CAAC;AAED,MAAM,WAAA,GAAc;AAIpB,IAAM,OAAO"}}]
}